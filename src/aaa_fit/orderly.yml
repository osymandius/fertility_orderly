script: aaa_fit.R

artefacts:
  - data:
      description: sd report
      filenames:
        - sd_report.csv
  # - data:
  #     description: tips
  #     filenames:
  #       - tips.csv
  - data:
      description: fertility indicator dataset
      filenames:
        - fr.csv
  # - data:
  #     description: hyperparameters and random effect samples
  #     filenames:
  #       - hyper.rds
  - staticgraph:
      description: Validate admin-1 TFRs
      filenames:
        - check/tfr_admin1.pdf
        - check/tfr_district.pdf


global_resources:
  resources/iso_mapping_fit.csv: iso_mapping_fit.csv
  # resources/mics_asfr.csv: mics_asfr.csv
  resources/phia_asfr.csv: phia_asfr.csv
  resources/phia_asfr_admin1.csv: phia_asfr_admin1.csv
  # resources/moz_areas_maputo.geojson: moz_areas_maputo.geojson

resources:
  # - parallel.cpp
  # - parallel.o
  # - parallel.so
  # - phia.cpp
  # - phia.o
  # - phia.so
  # - no_tips.cpp
  # - no_tips.o
  # - no_tips.so
  - dev.cpp
  - dev.so
  - dev.o



displayname: Fertility model fit

parameters:
  iso3:
    default: ~

packages:
  - dplyr
  - tidyr
  - dfertility
  - ggplot2
  - naomi
  - tidyverse
  - sf
  - stringr
  - TMB
  - Matrix
  - forcats
  # - parallel
  - purrr
  - rlang
  - mgcv



depends:
  aaa_areas_pull:
    id: latest(parameter:iso3 == iso3)
    use:
      depends/naomi_areas.geojson: naomi_areas.geojson
  aaa_asfr:
    id: latest(parameter:iso3 == iso3)
    use:
      depends/asfr.csv: asfr.csv
      depends/fr_plot.csv: fr_plot.csv
  aaa_scale_pop:
    id: latest(parameter:iso3 == iso3)
    use:
      depends/interpolated_population.csv: interpolated_population.csv